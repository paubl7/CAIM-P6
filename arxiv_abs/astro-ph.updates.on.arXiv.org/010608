Stellar magnetic activity produces time-varying distortions in the photospheric line profiles
of solar-type stars. The changing shape of the profile produces systematic errors in high-precision
radial-velocity measurements, which limit efforts to discover and measure the masses of low-mass
exoplanets with orbital periods of more than a few tens of days. We present a new data-driven method
for separating Doppler shifts of dynamical origin from apparent velocity variations arising from
variability-induced changes in the stellar spectrum. It uses the invariance to translation in
the velocity domain of the autocorrelation function of the spectrum (and of its cross-correlation
function). By projecting the measured velocity time series onto the principal components of the
autocorrelation function, we isolate the velocity perturbations caused by solar magnetic activity.
Dynamical shifts are preserved when we subtract the projected perturbations from the original
velocity measurements. We demonstrate its effectiveness using a 5-year time sequence of 880 daily-averaged
cross-correlation functions of the solar spectrum from the HARPS-N instrument and solar-telescope
feed on the 3.58-m Telescopio Nazionale Galileo, reduced with a new version of the HARPS-N data-reduction
pipeline. We inject synthetic low-mass planet signals with amplitude $K=40$ cm s$^{-1}$ into the
solar observations at a wide range of orbital periods. We find that our method isolates these signals
effectively from solar activity signals. Their semi-amplitudes are recovered with a precision
of $\sim 4.4$ cm~s$^{-1}$, opening the door to Doppler detection and characterization of terrestrial-mass
planets around well-observed, bright main-sequence stars across a wide range of orbital periods.
