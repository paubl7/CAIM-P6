One of the top remaining science challenges in astronomical optics is the direct imaging and characterization
of extrasolar planets and planetary systems. Directly imaging exoplanets from ground-based observatories
requires combining high-order adaptive optics with a stellar coronagraph observing at wavelengths
ranging from the visible to the mid-IR. A limiting factor in achieving the required contrast (planet-to-star
intensity ratio) is quasi-static speckles, caused largely by non-common path aberrations (NCPA)
in the coronagraph. Starting with a realistic simulator of a telescope with an AO system and a coronagraph,
this article provides simulations of several closely related millisecond regression models requiring
inputs of the measured wavefronts and science camera images. The simplest regression model, called
the naive estimator, does not treat the noise and other sources of information loss in the WFS. The
naive estimator provided a useful estimate of the NCPA of $\sim$ 0.5 radian RMS, with an accuracy
of $\sim$ 0.06 radian RMS in one minute of simulated sky time on a magnitude 8 star. The bias-corrected
estimator generalizes the regression model to account for the noise and information loss in the
WFS. A simulation of the bias-corrected estimator with four minutes of sky time included an NCPA
of $\sim 0.05 \,$ radian RMS and an extended exoplanet scene. The joint regression of the bias-corrected
estimator simultaneously achieved an NCPA estimate with an accuracy of $\sim 5\times10^{-3} \,$radian
and contrast of $\sim 10^{-5}$ on the exoplanet scene. In addition, the estimate of the exoplanet
image was completely free of the subtraction artifacts that always plague differential imaging.
The estimate of the exoplanet image obtained by the joint regression was nearly identical to the
image obtained by subtraction of a perfectly known point-spread function. 