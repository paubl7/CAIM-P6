The amount of nebular gas that a planet can bind is limited by its cooling rate, which is set by the opacity
of its envelope. Accreting dust and pebbles contribute to the envelope opacity and, thus, influence
the outcome of planet formation. Our aim is to model the size evolution and opacity contribution
of solids inside planetary envelopes. We then use the resultant opacity relations to study emergent
trends in planet formation. We design a model for the opacity of solids in planetary envelopes that
accounts for the growth, fragmentation and erosion of pebbles during their sedimentation. We formulate
analytical expressions for the opacity of pebbles and dust and map out their trends as a function
of depth, planet mass, distance and accretion rate. We find that the accretion of pebbles rather
than planetesimals can produce fully convective envelopes, but only in lower-mass planets that
reside in the outer disk or in those that are accreting pebbles at a high rate. In these conditions,
pebble sizes are limited by fragmentation and erosion, allowing them to pile up in the envelope.
At higher planetary masses or reduced accretion rates, a different regime applies where the sizes
of sedimenting pebbles are only limited by their rate of growth. The opacity in this growth-limited
regime is much lower, steeply declines with depth and planet mass but is invariant with the pebble
mass flux. Our results imply that the opacity of a forming planetary envelope can not be approximated
by a value that is constant with either depth or planet mass. When applied to the Solar System, we argue
that Uranus and Neptune could not have maintained a sufficiently high opacity to avoid runaway gas
accretion unless they both experienced sufficiently rapid accretion of solids and formed late.
