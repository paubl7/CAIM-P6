We derive the exact analytic insulator ground states of the projected Hamiltonian of magic-angle
twisted bilayer graphene (TBG) flat bands with Coulomb interactions in various limits, and study
the perturbations away from these limits. We define the (first) chiral limit where the AA stacking
hopping is zero, and a flat limit with exactly flat bands. In the chiral-flat limit, the TBG Hamiltonian
has a U(4)$\times$U(4) symmetry, and we find that the exact ground states at integer filling $-4\le
\nu\le 4$ relative to charge neutrality are Chern insulators of Chern numbers $\nu_C=4-|\nu|,2-|\nu|,\cdots,|\nu|-4$,
all of which are degenerate. This confirms recent experiments where Chern insulators are found
to be competitive low-energy states of TBG. When the chiral-flat limit is reduced to the nonchiral-flat
limit which has a U(4) symmetry, we find $\nu=0,\pm2$ has exact ground states of Chern number $0$,
while $\nu=\pm1,\pm3$ has perturbative ground states of Chern number $\nu_C=\pm1$, all of which
are U(4) ferromagnetic. In the chiral-nonflat limit which has a different U(4) symmetry, different
Chern number states are degenerate up to second order perturbations. When reduced to the realistic
nonchiral-nonflat case, we find that the perturbative insulator states with Chern number $|\nu_C|<4-|\nu|$
at integer fillings $\nu$ are intervalley coherent, while the insulator states with Chern number
$|\nu_C|=4-|\nu|$ are almost degenerate between valley polarization and intervalley coherence,
with valley polarization slightly favored by 0.005meV/electron. At nonzero magnetic field $|B|>0$,
a first-order phase transition for $\nu=\pm1,\pm2$ from Chern number $\nu_C=\text{sgn}(\nu
B)(2-|\nu|)$ to $\nu_C=\text{sgn}(\nu B)(4-|\nu|)$ is expected, which agrees with recent experimental
observations. Lastly, the TBG Hamiltonian reduces into an extended Hubbard model in the stabilizer
code limit. 