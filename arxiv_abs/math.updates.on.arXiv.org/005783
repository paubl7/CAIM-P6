We study amenability of definable groups and topological groups, and prove various results, briefly
described below. Among our main technical tools, of interest in its own right, is an elaboration
on and strengthening of the Massicot-Wagner version of the stabilizer theorem, and also some results
about measures and measure-like functions (which we call means and pre-means). As an application
we show that if $G$ is an amenable topological group, then the Bohr compactification of $G$ coincides
with a certain ``weak Bohr compactification'' introduced in [24]. In other words, the conclusion
says that certain connected components of $G$ coincide: $G^{00}_{topo} = G^{000}_{topo}$. We
also prove wide generalizations of this result, implying in particular its extension to a ``definable-topological''
context, confirming the main conjectures from [24]. We also introduce $\bigvee$-definable group
topologies on a given $\emptyset$-definable group $G$ (including group topologies induced by
type-definable subgroups as well as uniformly definable group topologies), and prove that the
existence of a mean on the lattice of closed, type-definable subsets of $G$ implies (under some assumption)
that $cl(G^{00}_M) = cl(G^{000}_M)$ for any model $M$. Thirdly, we give an example of a $\emptyset$-definable
approximate subgroup $X$ in a saturated extension of the group $\mathbb{F}_2 \times \mathbb{Z}$
in a suitable language (where $\mathbb{F}_2$ is the free group in 2-generators) for which the $\bigvee$-definable
group $H:=\langle X \rangle$ contains no type-definable subgroup of bounded index. This refutes
a conjecture by Wagner and shows that the Massicot-Wagner approach to prove that a locally compact
(and in consequence also Lie) ``model'' exists for each approximate subgroup does not work in general
(they proved in [29] that it works for definably amenable approximate subgroups). 