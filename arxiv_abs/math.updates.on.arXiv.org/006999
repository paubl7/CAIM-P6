Let $G$ be an $n$-vertex graph with adjacency matrix $A$, and $W=[e,Ae,\ldots,A^{n-1}e]$ be the
walk-matrix of $G$, where $e$ is the all-one vector. In Wang [J. Combin. Theory, Ser. B, 122 (2017):
438-451], the author showed that any graph $G$ is uniquely determined by its generalized spectrum
(DGS) whenever $2^{-\lfloor n/2 \rfloor}\det W$ is odd and square-free. In this paper, we introduce
a family of graphs $\mathcal{F}_n=\{$ $n$-vertex graphs $G\colon\, 2^{-\lfloor n/2 \rfloor}\det
W =p^2b$ and rank$W=n-1$ over $\mathbb{Z}/p\mathbb{Z}\},$ where $b$ is odd and square-free, $p$
is an odd prime and $p\nmid b$. We prove that any graph in $\mathcal{F}_n$ either is DGS or has exactly
one generalized cospectral mate up to isomorphism. Moreover, we show that the problem of finding
the generalized cospectral mate for a graph in $\mathcal{F}_n$ is equivalent to the problem of generating
an appropriate rational orthogonal matrix from a given vector. This equivalence essentially depends
on an amazing property of graphs in terms of generalized spectra, which states that any symmetric
integral matrix generalized cospectral with the adjacency matrix of some graph must be an adjacency
matrix. Based on this equivalence, we develop an efficient algorithm to decide whether a given graph
in $\mathcal{F}_n$ is DGS and further to find the unique generalized cospectral mate when it is not.
We give some experimental results on graphs with at most 20 vertices, which suggest that $\mathcal{F}_n$
may have a positive density (nearly $3\%$) and possibly almost all graphs in $\mathcal{F}_n$ are
DGS as $n\rightarrow \infty$. This gives a supporting evidence for Haemers' conjecture that almost
all graphs are determined by their spectra. 