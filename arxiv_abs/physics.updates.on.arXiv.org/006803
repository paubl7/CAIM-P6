Despite decades of practice, finite-size errors in many widely used electronic structure theories
for periodic systems remain poorly understood. For periodic systems using a general Monkhorst-Pack
grid, there has been no rigorous analysis of the finite-size error in the Hartree-Fock theory (HF)
and the second order M{\o}ller-Plesset perturbation theory (MP2), which are the simplest wavefunction
based method, and the simplest post-Hartree-Fock method, respectively. Such calculations can
be viewed as a multi-dimensional integral discretized with certain trapezoidal rules. Due to the
Coulomb singularity, the integrand has many points of discontinuity in general, and standard error
analysis based on the Euler-Maclaurin formula gives overly pessimistic results. The lack of analytic
understanding of finite-size errors also impedes the development of effective finite-size correction
schemes. We propose a unified method to obtain sharp convergence rates of finite-size errors for
the periodic HF and MP2 theories. Our main technical advancement is a generalization of the result
of [Lyness, 1976] for obtaining sharp convergence rates of the trapezoidal rule for a class of non-smooth
integrands. Our result is applicable to three-dimensional bulk systems as well as low dimensional
systems (such as nanowires and 2D materials). Our unified analysis also allows us to prove the effectiveness
of the Madelung-constant correction to the Fock exchange energy, and the effectiveness of a recently
proposed staggered mesh method for periodic MP2 calculations [Xing, Li, Lin, 2021]. Our analysis
connects the effectiveness of the staggered mesh method with integrands with removable singularities,
and suggests a new staggered mesh method for reducing finite-size errors of periodic HF calculations.
